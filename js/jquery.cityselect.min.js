(function(a){a.fn.citySelect=function(d){if(this.length<1){return}d=a.extend({url:"http://static.qunju.ren/js/city.min.js",prov:null,city:null,dist:null,nodata:null,required:true},d);var f=this;var c=f.find(".prov");var n=f.find(".city");var m=f.find(".dist");var l=d.prov;var i=d.city;var h=d.dist;var b=(d.required)?"":"<option value=''>选省份</option>";var g;var k=function(){var o=c.get(0).selectedIndex;if(!d.required){o--}if(o<0||typeof(g.citylist[o].c)=="undefined"){if(d.nodata=="none"){n.css("display","none");m.css("display","none")}else{if(d.nodata=="hidden"){n.css("visibility","hidden");m.css("visibility","hidden")}}n.html("<option value=''>选城市</option>").attr("disabled",false).css({"display":"","visibility":""});m.html("<option value=''>选地区</option>").attr("disabled",false).css({"display":"","visibility":""});return}var p=c.val();var q=true;if(p=="北京"||p=="天津"||p=="上海"||p=="重庆"){temp_html="<option value=''>选地区</option>";m.css("display","none");q=false}else{temp_html="<option value=''>选城市</option>";q=true}a.each(g.citylist[o].c,function(r,s){temp_html+="<option value='"+s.n+"'>"+s.n+"</option>"});n.html(temp_html).removeAttr("disabled").css({"display":"","visibility":""});if(q){m.html("<option value=''>选地区</option>").removeAttr("disabled").css({"display":"","visibility":""})}e()};var e=function(){var o=c.get(0).selectedIndex;var p=n.get(0).selectedIndex;if(!d.required){o--;p--}if(o<0||p<0||typeof(g.citylist[o].c[p].a)=="undefined"){if(d.nodata=="none"){m.css("display","none")}else{if(d.nodata=="hidden"){m.css("visibility","hidden")}}return}temp_html="<option value=''>选地区</option>";a.each(g.citylist[o].c[p].a,function(q,r){temp_html+="<option value='"+r.s+"'>"+r.s+"</option>"});m.html(temp_html).removeAttr("disabled").css({"display":"","visibility":""})};var j=function(){temp_html=b;a.each(g.citylist,function(p,o){temp_html+="<option value='"+o.p+"'>"+o.p+"</option>"});c.html(temp_html);n.html("<option value=''>选城市</option>").attr("disabled",false).css({"display":"","visibility":""});m.html("<option value=''>选地区</option>").attr("disabled",false).css({"display":"","visibility":""});setTimeout(function(){if(d.prov!=null){c.val(d.prov);k();setTimeout(function(){if(d.city!=null){n.val(d.city);e();setTimeout(function(){if(d.dist!=null){m.val(d.dist)}},1)}},1)}},1);c.bind("change",function(){k()});n.bind("change",function(){e()})};if(typeof(d.url)=="string"){a.getJSON(d.url,function(o){g=o;j()})}else{g=d.url;j()}};a.fn.cityCheck=function(){var e=this;var h=e.find(".prov");var b=e.find(".city");var d=e.find(".dist");var c=h.get(0).selectedIndex;var g=b.get(0).selectedIndex;var f=d.get(0).selectedIndex;if(c==0){toast("请选择省份!");return false}if(g==0){var i=h.val();if(i=="北京"||i=="天津"||i=="上海"||i=="重庆"){toast("请选择地区!");return false}else{toast("请选择城市!");return false}}if(f==0){var i=h.val();if(i=="北京"||i=="天津"||i=="上海"||i=="重庆"){}else{toast("请选择地区!");return false}}return true}})(jQuery);